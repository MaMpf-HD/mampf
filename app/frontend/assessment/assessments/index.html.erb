<%= turbo_frame_tag "assessment-assessments-frame" do %>
  <% I18n.with_locale(@lecture.locale_with_inheritance || I18n.default_locale) do %>
    <h3 class="lecture-pane-header">
      <%= @lecture.seminar? ? t('assessment.talks') : t('assessment.assignments') %>
    </h3>

    <% if @lecture.seminar? %>
      <div class="alert alert-info mb-3">
        <i class="bi bi-info-circle me-2"></i>
        <%= t('assessment.info.talks_created_in_roster') %>
      </div>
    <% else %>
      <div class="row mb-3">
        <div class="col-12 text-center">
          <%= link_to t('admin.assignment.new'),
                      new_assignment_path(params: { lecture_id: @lecture.id }),
                      class: 'btn btn-sm btn-primary',
                      id: 'newAssignmentButton',
                      data: { turbo_stream: true } %>
        </div>
      </div>

      <div id="assignment_form_container"></div>
    <% end %>

    <% if @assessables_with_assessment.any? %>
      <table class="table table-hover mb-4">
        <thead>
          <tr>
            <th><%= t('admin.assignment.title') %></th>
            <th><%= t('assessment.status.title') %></th>
            <th><%= t('assessment.due_at') %></th>
            <th><%= t('medium.singular') %></th>
            <th><%= t('admin.assignment.filetype') %></th>
            <th class="text-center"><%= t('assessment.tasks') %></th>
            <th><%= t('admin.assignment.deletion') %></th>
            <th></th>
          </tr>
        </thead>
        <tbody id="assessment-assessments-list">
          <% @assessables_with_assessment.each do |assessable| %>
            <%= render AssessmentListItemComponent.new(assessable: assessable, lecture: @lecture) %>
          <% end %>
        </tbody>
      </table>
    <% else %>
      <table class="table table-hover mb-4">
        <thead>
          <tr>
            <th><%= t('admin.assignment.title') %></th>
            <th><%= t('assessment.status.title') %></th>
            <th><%= t('assessment.due_at') %></th>
            <th><%= t('medium.singular') %></th>
            <th><%= t('admin.assignment.filetype') %></th>
            <th class="text-center"><%= t('assessment.tasks') %></th>
            <th><%= t('admin.assignment.deletion') %></th>
          </tr>
        </thead>
        <tbody id="assessment-assessments-list">
        </tbody>
      </table>
    <% end %>

    <% if @assessables_with_assessment.empty? && @legacy_assessables.empty? %>
      <div class="text-center text-muted py-4">
        <%= @lecture.seminar? ? t('assessment.no_talks_yet') : t('assessment.no_assignments_yet') %>
      </div>
    <% end %>

    <% unless @lecture.seminar? %>
      <div class="lecture-pane-separator"></div>
      <h5 class="mb-3">
        <%= t('assessment.submission_settings') %>
      </h5>

      <%= turbo_frame_tag "lecture-submission-settings" do %>
        <%= render "assessment/assessments/submission_settings", lecture: @lecture %>
      <% end %>
    <% end %>

    <% if @legacy_assessables.any? %>
      <div class="lecture-pane-separator"></div>
      <h5 class="mb-3">
        <%= t('assessment.legacy_items') %>
      </h5>
      <p class="text-muted small mb-3">
        <%= t('assessment.legacy_items_subtitle') %>
      </p>
      <div data-turbo="false">
        <div class="list-group">
          <% @legacy_assessables.each do |assessable| %>
            <% if assessable.is_a?(Assignment) %>
              <%= render 'assignments/row', assignment: assessable %>
            <% else %>
              <%= render AssessmentListItemComponent.new(assessable: assessable, lecture: @lecture, legacy: true) %>
            <% end %>
          <% end %>
        </div>
      </div>
    <% end %>
  <% end %>
<% end %>
