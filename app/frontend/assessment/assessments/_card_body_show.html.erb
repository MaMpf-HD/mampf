<div class="mb-3">
  <%= link_to assessment_assessments_path(lecture_id: lecture.id),
              class: "btn btn-sm btn-outline-secondary",
              role: "button",
              data: { turbo_stream: true } do %>
    <i class="bi bi-arrow-left"></i> <%= t("back") %>
  <% end %>
</div>

<div class="d-flex justify-content-between align-items-center mb-4">
  <h3><%= assessable.title %></h3>
  <div class="d-flex gap-2">
    <%# Settings/Edit button placeholder %>
  </div>
</div>

<% tab ||= "overview" %>
<ul class="nav nav-tabs mb-3" id="assessmentTabs" role="tablist">
  <li class="nav-item" role="presentation">
    <button class="nav-link <%= 'active' if tab == 'overview' %>"
            id="overview-tab"
            data-bs-toggle="tab"
            data-bs-target="#overview"
            type="button"
            role="tab"
            aria-controls="overview"
            aria-selected="<%= tab == 'overview' %>">
      <%= t("basics.overview") %>
    </button>
  </li>
  <li class="nav-item" role="presentation">
    <button class="nav-link <%= 'active' if tab == 'settings' %>"
            id="settings-tab"
            data-bs-toggle="tab"
            data-bs-target="#settings"
            type="button"
            role="tab"
            aria-controls="settings"
            aria-selected="<%= tab == 'settings' %>">
      <%= t("basics.settings") %>
    </button>
  </li>
  <li class="nav-item" role="presentation">
    <button class="nav-link <%= 'active' if tab == 'tasks' %>"
            id="tasks-tab"
            data-bs-toggle="tab"
            data-bs-target="#tasks"
            type="button"
            role="tab"
            aria-controls="tasks"
            aria-selected="<%= tab == 'tasks' %>">
      <%= t("assessment.tasks") %>
      <% if assessment.tasks.any? %>
        <span class="badge bg-secondary ms-1"><%= assessment.tasks.count %></span>
      <% end %>
    </button>
  </li>
  <li class="nav-item" role="presentation">
    <button class="nav-link <%= 'active' if tab == 'participations' %>"
            id="participations-tab"
            data-bs-toggle="tab"
            data-bs-target="#participations"
            type="button"
            role="tab"
            aria-controls="participations"
            aria-selected="<%= tab == 'participations' %>">
      <%= t("assessment.participations") %>
      <% if participations_count.to_i > 0 %>
        <span class="badge bg-secondary ms-1"><%= participations_count %></span>
      <% end %>
    </button>
  </li>
</ul>

<div class="tab-content" id="assessmentTabsContent">
  <div class="tab-pane fade <%= 'show active' if tab == 'overview' %>" id="overview" role="tabpanel" aria-labelledby="overview-tab">
    <div class="card card-body bg-light">
      <dl class="row mb-0">
        <dt class="col-sm-3"><%= t("basics.title") %></dt>
        <dd class="col-sm-9"><%= assessable.title %></dd>

        <dt class="col-sm-3"><%= t("basics.type") %></dt>
        <dd class="col-sm-9"><%= assessable.class.model_name.human %></dd>

        <dt class="col-sm-3"><%= t("assessment.total_points") %></dt>
        <dd class="col-sm-9"><%= assessment.total_points || 0 %></dd>
      </dl>
    </div>
  </div>

  <div class="tab-pane fade <%= 'show active' if tab == 'settings' %>" id="settings" role="tabpanel" aria-labelledby="settings-tab">
    <p class="text-muted">Settings form placeholder (Phase 3)</p>
  </div>

  <div class="tab-pane fade <%= 'show active' if tab == 'tasks' %>" id="tasks" role="tabpanel" aria-labelledby="tasks-tab">
    <% if tasks.any? %>
      <div class="list-group">
        <% tasks.each do |task| %>
          <div class="list-group-item">
             <%= task.title %> (<%= task.points %> pts)
          </div>
        <% end %>
      </div>
    <% else %>
      <p class="text-muted"><%= t("assessment.no_tasks_yet") %></p>
    <% end %>
    <div class="mt-3">
       <button class="btn btn-primary btn-sm" disabled>Add Task (Phase 4)</button>
    </div>
  </div>

  <div class="tab-pane fade <%= 'show active' if tab == 'participations' %>" id="participations" role="tabpanel" aria-labelledby="participations-tab">
    <p class="text-muted">Participations list placeholder (Phase 5)</p>
  </div>
</div>
