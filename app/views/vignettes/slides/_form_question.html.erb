<%= form.fields_for :question do |f| %>

<!-- Question Type Selection -->
<div class="form-floating">
    <%= f.select :type,
        options_for_select([
            ['No Question', ''],
            ['Text Area', 'Vignettes::TextQuestion'],
            ['Multiple Choice', 'Vignettes::MultipleChoiceQuestion'],
            ['Likert Scale', 'Vignettes::LikertScaleQuestion']
        ], f.object.type),
        {},
        {
            class: "form-select",
            id: "vignettes-question-type-select",
            "aria-label": "Selection for question type"
        } %>
    <%= f.label :type, "Question Type" %>
</div>

<div id="vignette-question-text" class="form-floating mt-3 show">
    <%= f.text_area :question_text,
        placeholder: '_',
        class: 'form-control',
        style: 'height: 120px',
        required: false
    %>
    <%= f.label :question_text, "Your question" %>
</div>

<div id="vignette-edit-multiple-choice" class="collapse mt-3">

    <div id="vignette-multiple-choice-options">
        <%= f.fields_for :options do |option_form| %>
            <%= render partial: "multiple_choice_fields", locals: { f: option_form } %>
        <% end %>
    </div>

    <!-- later with Stimulus: -->
    <!-- https://jonathanyeong.com/rails-stimulus-dynamic-nested-form/ -->
    <template id="vignette-multiple-choice-options-template" class="d-none">
        <%= f.fields_for :options, f.object.options.build,
                         child_index: 'NEW_RECORD' do |option_form| %>
            <%= render partial: "multiple_choice_fields", locals: { f: option_form } %>
        <% end %>
    </template>
    
    <button type="button" id="vignette-multiple-choice-add"
            class="btn btn-outline-secondary">
        <i class="bi bi-plus-circle"></i>
        Add Multiple Choice Option
    </button>
</div>

<% end %>

<%= javascript_include_tag 'vignettes/question_type' %>
