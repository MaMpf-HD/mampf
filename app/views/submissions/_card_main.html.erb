<div class="card-body submissionBody"
     data-id="<%= assignment.id %>">
  <% if submission %>
    <table class="table table-bordered submission-table-bordered">
      <tbody>
        <tr>
          <th scope="row">
            <%= t('basics.tutorial') %>
          </th>
          <td>
            <%= submission.tutorial.title_with_tutor %>
          </td>
        </tr>
        <% if assignment.active? %>
          <tr>
            <th scope="row">
              <%= t('basics.code') %>
            </th>
            <td>
              <span class="submissionToken" data-id="<%= submission.id %>">
                <%= submission.token %>
              </span>
              <i class="far fa-copy clickable text-secondary clipboard-btn ml-3"
                id="clipboard-button"
                data-clipboard-text="<%= submission.token %>"
                data-toggle="tooltip"
                title="<%= t('buttons.copy_to_clipboard') %>">
              </i>
              <%= link_to '',
                          refresh_submission_token_path(submission),
                          class: 'fas fa-sync-alt text-secondary ml-2',
                          id: 'refreshTokenButton',
                          data: { toggle: 'tooltip',
                                  placement: 'bottom' },
                          title: t('buttons.refresh_token'),
                          style: 'text-decoration: none;',
                          remote: true,
                          method: :patch %>
            </td>
          </tr>
        <% end %>
        <tr>
          <th scope="row">
            <%= t('basics.files') %>
          </th>
          <td>
            <% if submission.manuscript %>
              <%= link_to 'Abgabe',
                          show_submission_manuscript_path(submission),
                          target: :_blank %> (kaputt)
              <% unless assignment.active? %>
                Korrektur
              <% end %>
            <% else %>
              <span class="<%= assignment.current? ? 'darkredtext' : '' %>">
                <%= t('submission.no_manuscript_yet') %>
              </span>
            <% end %>
          </td>
        </tr>
        <tr>
          <th scope="row">
            <%= t('basics.team') %>
          </th>
          <td>
            <% if submission.users.count == 1 %>
              <%= t('basics.you') %>
            <% else %>
              <%= submission.partners_of_user(current_user).map(&:name)
                            .join(', ') + ' ' + t('basics.and_you') %>
            <% end %>
          </td>
        </tr>
        <% if assignment.active? %>
          <tr>
            <th scope="row">
              <%= t('basics.invited') %>
            </th>
            <td>
              <% if submission.invited_users.any? %>
                <%= submission.invited_users.map(&:name)
                              .join(', ') %>
              <% else %>
                <%= t('basics.nobody') %>
              <% end %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  <% else %>
    <% if assignment.current? %>
      <span class="darkredtext">
        <%= t('submission.nothing_here') %>
      </span>
    <% elsif assignment.active? %>
      <%= t('submission.nothing_here') %>
    <% else %>
      <%= t('submission.nothing_here_past') %>
    <% end %>
  <% end %>
</div>
<% if assignment.active? %>
  <div class="card-footer submissionFooter"
       data-id="<%= assignment.id %>">
    <div class="row">
      <div class="col-12 text-center">
        <% if assignment.active? %>
          <% if submission %>
            <%= link_to t('buttons.edit'),
                        edit_submission_path(submission),
                        class: 'btn btn-sm btn-outline-primary',
                        remote: true,
                        data: { color: 'btn-outline-primary'} %>
            <% if submission.admissible_invitees(current_user).any? %>
              <%= link_to t('buttons.invite'),
                          enter_submission_invitees_path(submission),
                          class: 'btn btn-sm btn-outline-primary',
                          remote: true,
                          data: { color: 'btn-outline-primary'} %>
            <% end %>
            <% if submission.users.count == 1 %>
              <%= link_to t('buttons.delete'),
                          submission_path(submission),
                          class: 'btn btn-sm btn-outline-danger',
                          method: :delete,
                          remote: true,
                          data: { confirm: t('confirmation.generic'),
                                  color: 'btn-outline-danger' } %>
            <% else %>
              <%= link_to t('buttons.leave'),
                          leave_submission_path(submission),
                          class: 'btn btn-sm btn-outline-danger',
                          method: :delete,
                          remote: true,
                          data: { confirm: t('confirmation.generic'),
                                  color: 'btn-outline-danger' } %>
            <% end %>
          <% else %>
            <%= link_to t('buttons.create'),
                        new_submission_path(params:
                                              { assignment_id: assignment.id }),
                        class: 'btn btn-sm btn-outline-primary',
                        remote: true,
                        data: { color: 'btn-outline-primary' } %>
            <%= link_to t('buttons.join'),
                        enter_submission_code_path(submission,
                                                    params:
                                                      { assignment_id:
                                                          assignment.id }),
                        class: 'btn btn-sm btn-outline-primary',
                        remote: true,
                        data: { color: 'btn-outline-primary' } %>
          <% end %>
        <% else %>
          <%= t('assignment.expired') %>
        <% end %>
      </div>
    </div>
  </div>
<% end %>