<div class="row mb-2">
  <div class="col-8 col-xl-6">
    <h2>
      <span class="badge badge-secondary">
        <%= @medium.sort_de %>
      </span>
      <% unless @medium.released_with_inheritance? %>
        <span class="badge badge-warning">
          unveröffentlicht
        </span>
      <% end %>
      <% if @medium.released_with_inheritance? && @medium.locked? %>
        <span class="badge badge-warning">
          gesperrt
        </span>
      <% end %>
      <%= @medium.caption %>
    </h2>
  </div>
  <div class="col-4 pt-2">
    <strong>
      zu:
    </strong>
    <% if @medium.teachable_type == 'Course' && @medium.teachable.present? %>
      <% if current_user.courses.include?(@medium.teachable) %>
        <%= link_to @medium.teachable.to_label,
                    @medium.teachable,
                    class: 'text-dark' %>
      <% else %>
        <span>
          <%= @medium.teachable.to_label %>
        </span>
      <% end %>
    <% end %>
    <% if @medium.teachable_type == 'Lecture' && @medium.teachable.present? %>
      <% if current_user.lectures.include?(@medium.teachable) %>
        <%= link_to @medium.teachable.to_label,
                    @medium.teachable.path(current_user),
                    class: 'text-dark' %>
      <% else %>
        <span>
          <%= @medium.teachable.to_label %>
        </span>
      <% end %>
    <% end %>
    <% if @medium.teachable_type == 'Lesson' && @medium.teachable.present? %>
      <% if current_user.lectures.include?(@medium.teachable.lecture) %>
        <%= link_to @medium.teachable.lecture.title_for_viewers,
                    @medium.teachable.lecture.path(current_user),
                    class: 'text-dark' %>,
        <%= link_to @medium.teachable.local_title_for_viewers,
                    @medium.teachable,
                    class: 'text-dark' %>
      <% else %>
        <%= @medium.teachable.lecture.to_label %>,
        <span>
          <%= @medium.teachable.to_label %>
        </span>
      <% end %>
    <% end %>
  </div>
  <div class="col-12 col-xl-2 text-right">
    <% if current_user.admin ||
          @medium.edited_with_inheritance_by?(current_user) %>
      <a href="<%= edit_medium_path(@medium) %>"
         class="far fa-edit fa-lg text-secondary"
         data-toggle="tooltip"
         data-placement="bottom"
         title="Bearbeiten"
         style="text-decoration: none;">
      </a>
    <% end %>
  </div>
</div>
<div class="row mb-2">
  <div class="col-12 col-lg-4 col-xl-3 col-xxl-2">
    <div class="row">
      <% if @medium.video.present? %>
        <div class="col-6 col-lg-12 mb-2">
          <%= render partial: 'media/video_card',
                     locals: { medium: @medium } %>
        </div>
      <% end %>
      <% if @medium.manuscript.present? %>
        <div class="col-6 col-lg-12 mb-2">
          <%= render partial: 'media/manuscript_card',
                     locals: { medium: @medium } %>
        </div>
      <% end %>
      <% if @medium.external_reference_link.present? %>
        <div class="col-6 col-lg-12 mt-2">
          <div class="card bg-light">
            <div class="card-header bg-brown text-light">
              Externer Link
            </div>
            <div class="card-body text-center">
              <%= link_to 'hier klicken',
                          @medium.external_reference_link,
                          class: "btn btn-info",
                          target: :_blank %>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  </div>
  <div class="col-12 col-lg-8 col-xl-6 col-xxl-7 mb-2">
    <div class="row">
      <% if @medium.tags.present? %>
        <div class="col-12 mb-2">
          <%= render partial: 'tags/tags',
                     locals: { related_tags: @medium.tags,
                               tags_description: 'Verknüpfte Begriffe',
                               small: true} %>
        </div>
      <% end %>
      <div class="col-12">
        <%= render partial: 'items/items',
                   locals: { items: @medium.proper_items_by_time,
                             small: true } %>
      </div>
    </div>
  </div>
  <div class="col-12 col-lg-12 col-xl-3 col-xxl-3">
    <% linked_media = current_user.filter_media(@medium.linked_media)
                                  .select { |m| m.released_with_inheritance? &&
                                                  !m.locked?} %>
    <%= render partial: 'media/related_media',
               locals: { media: linked_media} %>
  </div>
</div>