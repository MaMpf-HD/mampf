<div class="action-box">
  <%= form_with model: item do |f|%>
    <div class="form-group form-row">
      <div class="col-2 col-form-label">
        Startzeit
      </div>
      <div class="col-auto">
        <%= f.text_field :start_time,
                         { value: item.start_time.simple_vtt_string, size: 12,
                           maxlength: 12, class: 'form-control' } %>
        <div class="invalid-feedback" id="start-time-error">
        </div>
      </div>
      <div class="col-1 col-form-label">
        <i class="material-icons clickable timer" data-toggle="tooltip"
           data-placement="right" title="Zeit aus Video übernehmen"
           data-timer="item_start_time">
          timer
        </i>
      </div>
    </div>
    <div class="form-group form-row">
      <div class="col-2 col-form-label">
        <%= f.label :sort, 'Typ' %>
      </div>
      <div class="col-auto">
        <%= f.select :sort, Item.internal_sorts, {},
                     { class: 'form-control' } %>
      </div>
    </div>
    <% if item.medium.sort == 'Kaviar' && item.medium.teachable_type.in?(['Lesson', 'Lecture']) %>
      <div id="item_section_select" class="form-group form-row">
        <div class="col-2 col-form-label">
          <%= f.label :section_id, 'Abschnitt' %>
        </div>
        <div class="col-10">
          <%= f.select :section_id,
                        options_for_select([['kein zugeordneter Abschnitt aus der Datenbank', '']] +
                                           item.medium.teachable.lecture
                                               .section_selection,
                                           item.section_id) ,
                        {},
                        { class: 'selectize'} %>
        </div>
      </div>
    <% else %>
      <%= f.hidden_field :section_id, value: '' %>
    <% end %>
    <div id="item_number_field" style="display: <%= show_no_block(item.sort != 'label') %>"
         class="form-group form-row">
      <div class="col-2 col-form-label">
        <%= f.label :ref_number, 'Nummer' %>
      </div>
      <div class="col-auto">
        <%= f.text_field :ref_number, class: 'form-control' %>
      </div>
    </div>
    <div id="item_description_field" class="form-group form-row">
      <div class="col-2 col-form-label">
        <%= f.label :description, 'Beschreibung' %>
      </div>
      <div class="col-auto">
        <%= f.text_field :description, { size: 50, class: 'form-control' } %>
      </div>
    </div>
    <% if item.manuscript? %>
      <div id="item_page_field" class="form-group form-row"
           style="display: <%= show_no_block(item.pdf_destination.blank?) %>">
        <div class="col-2 col-form-label">
          <%= f.label :page, 'Seite im pdf' %>
        </div>
        <div class="col-auto">
          <%= f.number_field :page,
                             { in: 1...item.medium.manuscript_pages + 1,
                               class: 'form-control' } %>
        </div>
        <div class="col-2">
          <%= link_to 'pdf', item.medium.manuscript[:original].url(host: host),
                      class: 'btn btn-outline-info', target: :blank %>
        </div>
      </div>
      <% if item.medium.manuscript_destinations.present? %>
        <div id="item_pdf_destination_field" class="form-group form-row">
          <div class="col-2 col-form-label">
            <%= f.label :pdf_destination, 'pdf-Zielpunkt' %>
          </div>
          <div class="col-10">
            <%= f.select :pdf_destination,
                         options_for_select([['auswählen (setzt Seitenauswahl außer Kraft)', '']] +
                                           (item.medium.manuscript_destinations | [item.pdf_destination])
                                             .map { |d| [d, d] },
                                           item.pdf_destination) ,
                    {},
                    { class: 'selectize'} %>
          </div>
        </div>
      <% end %>
    <% end %>
    <div>
      <%= f.hidden_field :medium_id, value: item.medium.id %>
      <%= f.submit 'Speichern', class: 'btn btn-primary' %>
      <button id="cancel-item" class="btn btn-secondary ml-3" type="button">
        Abbrechen
      </button>
      <% if item.id.present? %>
      <%= link_to 'Löschen', item_path(item), method: :delete, remote: true,
                  data: { confirm: 'Bist Du sicher?' }, id: 'delete-item',
                  class: 'btn btn-danger' %>
      <% end %>
    </div>
  <% end %>
</div>
