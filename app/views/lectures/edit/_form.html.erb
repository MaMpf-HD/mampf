<% cache lecture do %>
  <div id="lecture-area">
    <%= render partial: 'lectures/edit/header',
               locals: { lecture: lecture } %>
    
    <!-- Menu to switch between "tabs" ("pillars") -->
    <nav class="nav nav-pills flex-column flex-sm-row justify-content-center">
      <button class="nav-link active" id="lecture-nav-content" role="link"
          data-bs-toggle="pill" data-bs-target="#lecture-pane-content"
          aria-controls="lecture-pane-content" aria-selected="true">
        <!-- TODO (Lectures): Localize -->
        Content
      </button>
      <button class="nav-link" id="lecture-nav-settings" role="link"
          data-bs-toggle="pill" data-bs-target="#lecture-pane-settings"
          aria-controls="lecture-pane-settings" aria-selected="false">
        Settings
      </button>
      <button class="nav-link" id="lecture-nav-people" role="link"
          data-bs-toggle="pill" data-bs-target="#lecture-pane-people"
          aria-controls="lecture-pane-people" aria-selected="false">
        People
      </button>
      <button class="nav-link" id="lecture-nav-orga" role="link"
          data-bs-toggle="pill" data-bs-target="#lecture-pane-orga"
          aria-controls="lecture-pane-orga" aria-selected="false">
        Orga
      </button>
      <button class="nav-link" id="lecture-nav-communication" role="link"
          data-bs-toggle="pill" data-bs-target="#lecture-pane-communication"
          aria-controls="lecture-pane-communication" aria-selected="false">
        Communication
      </button>
      <button class="nav-link" id="lecture-nav-homework" role="link"
          data-bs-toggle="pill" data-bs-target="#lecture-pane-homework"
          aria-controls="lecture-pane-homework" aria-selected="false">
        Homework
      </button>
      <button class="nav-link" id="lecture-nav-info" role="link"
        data-bs-toggle="pill" data-bs-target="#lecture-pane-info"
        aria-controls="lecture-pane-info" aria-selected="false">
        Info
      </button>
    </nav>

    <div class="tab-content">
      <!-- Content (structure & media) -->
      <div class="tab-pane fade show active" id="lecture-pane-content"
          aria-labelledby="lecture-nav-content" tabindex="0">
        <div class="row px-4 py-2">
          <% if !lecture.seminar? || lecture.legacy_seminar %>
            <div id="lecture-content-card" class="col-12 col-xxl-9 mb-1">
              <%= render partial: 'lectures/edit/content',
                  locals: { lecture: lecture } %>
            </div>
          <% else %>
            <div id="lecture-content-card" class="col-12 col-xxl-9 mb-1">
              <%= render partial: 'lectures/edit/seminar_content',
                  locals: { lecture: lecture } %>
            </div>
          <% end %>
          <div id="lecture-media-card" class="col-12 col-xxl-3 mb-1">
            <%= render partial: 'lectures/edit/media',
                locals: { media: media, lecture: lecture } %>
          </div>
        </div>
      </div>
      
      <!-- Settings -->
      <div class="tab-pane fade" id="lecture-pane-settings"
          aria-labelledby="lecture-nav-settings" tabindex="0">
        <div class="container small-width">
          <%= render partial: 'lectures/edit/preferences',
              locals: { lecture: lecture } %>
        </div>
      </div>

      <!-- People -->
      <div class="tab-pane fade" id="lecture-pane-people"
          aria-labelledby="lecture-nav-people" tabindex="0">
        <div class="container small-width">
          <%= render partial: 'lectures/edit/people',
              locals: { lecture: lecture } %>
          <%= render partial: 'lectures/edit/tutorials',
              locals: { lecture: lecture } %>
        </div>
      </div>

      <!-- Organisation -->
      <div class="tab-pane fade" id="lecture-pane-orga"
          aria-labelledby="lecture-nav-orga" tabindex="0">
        <div class="container small-width">
          <%= render partial: 'lectures/edit/organizational_concept',
              locals: { lecture: lecture } %>
        </div>
      </div>

      <!-- Communication -->
      <div class="tab-pane fade" id="lecture-pane-communication"
          aria-labelledby="lecture-nav-communication" tabindex="0">
        <div class="container small-width">
          <%= render partial: 'lectures/edit/announcements',
              locals: { lecture: lecture, announcements: announcements } %>
          <%= render partial: 'lectures/edit/forum',
              locals: { lecture: lecture } %>
          <%= render partial: 'lectures/edit/comments',
              locals: { lecture: lecture } %>
        </div>
      </div>

      <!-- Homework -->
      <div class="tab-pane fade" id="lecture-pane-homework"
          aria-labelledby="lecture-nav-homework" tabindex="0">
        <div class="container small-width">
          <%= render partial: 'lectures/edit/assignments',
              locals: { lecture: lecture } %>
        </div>
      </div>

      <!-- Info -->
      <div class="tab-pane fade" id="lecture-pane-info"
          aria-labelledby="lecture-nav-info" tabindex="0">
        <div class="container small-width">
          <%= render partial: 'lectures/edit/tags',
              locals: { lecture: lecture } %>
          <%= render partial: 'lectures/edit/imported_media',
              locals: { lecture: lecture } %>
          <%= render partial: 'lectures/edit/erdbeere',
              locals: { lecture: lecture } %>
        </div>
      </div>
    </div>
  </div>


  <!-- TODO (Lectures): Find out when these partials are used -->
  <%= render partial: 'media/modal' %>
  <%= render partial: 'sections/content_modal' %>
  <%= render partial: 'tags/modal' %>
  <%= render partial: 'announcements/modal' %>
  <%= render partial: 'lectures/publish/publish',
             locals: { lecture: lecture } %>
   
  <% unless lecture.stale? %>
    <%= render partial: 'lectures/edit/user_modal',
               locals: { lecture: lecture } %>
  <% end %>

  <% if !lecture.seminar? || lecture.legacy_seminar %>
    <%= render partial: 'chapters/modal',
               locals: { lecture: lecture } %>
    <%= render partial: 'sections/modal' %>
    <%= render partial: 'lessons/modal' %>
  <% else %>
    <%= render partial: 'talks/modal',
               locals: { lecture: lecture } %>
  <% end %>

  <% if lecture.importable_toc? %>
    <%= render partial: 'lectures/edit/import_toc_modal',
              locals: { lecture: lecture } %>
  <% end %>

<% end %>
