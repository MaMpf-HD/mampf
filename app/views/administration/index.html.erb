<div class="row mt-3">
  <div class="col-8">
    <div class="row">
      <div class="col-7">
        <div class="card">
          <div class="card-header bg-primary text-white">
            <div class="row">
              <div class="col-8">
                Meine Vorlesungen
                <i class="far fa-question-circle helpdesk ml-2" 
                   tabindex="0"  
                   data-toggle="popover" data-trigger="focus" 
                   title="Info" 
                   data-content="Dies ist eine Liste aller Vorlesungen, für die Du Bearbeitungsrechte hast.">
                </i>
              </div>
              <div class="col-4">
                <%= link_to 'Vorlesung anlegen', new_lecture_path,
                             class: 'btn btn-outline-light',
                             remote: true,
                             id: 'new-lecture-button' %>
              </div>
            </div>
          </div>
          <div class="card-body">
            <div id="new-lecture-area"
                 class="bg-green-lighten-4 p-3 mb-3 rounded"
                 style="display: none;">
            </div>
            <% if current_user.given_lectures.present? %>
              als DozentIn
              (<%= current_user.given_lectures.count %>)
              <i class="far fa-question-circle helpdesk ml-2" 
                 tabindex="0"  
                 data-toggle="popover" data-trigger="focus" 
                 title="Info" 
                 data-content="Dies ist eine Liste aller Vorlesungen, die Du als
                 Dozent verantwortet hast. Für diese hast Du natürlich die Bearbeitungsberechtigung.">
              </i>
              <%= render partial: 'administration/lectures_card',
                         locals: { lectures: Lecture.sort_by_date(current_user.given_lectures),
                                   inspection: false,
                                   teacher: false } %>
            <% end %>
            <% if current_user.edited_lectures.present? %>
              als zusätzlicher Vorlesungeditor
              (<%= current_user.edited_lectures.count %>)
              <i class="far fa-question-circle helpdesk ml-2" 
                 tabindex="0"  
                 data-toggle="popover" data-trigger="focus" 
                 title="Info" 
                 data-content="Dies ist eine Liste aller Vorlesungen, für die als
                 zusätzlicher Editor eingetragen bist. Dadurch hast Du Bearbeitungsrechte an diesen Vorlesungen.">
              </i>
              <%= render partial: 'administration/lectures_card',
                         locals: { lectures: Lecture.sort_by_date(current_user.edited_lectures),
                                   inspection: false,
                                   teacher: true } %>
            <% end %>
            <% if current_user.lectures_as_module_editor.present? %>
              als Moduleditor
              (<%= current_user.lectures_as_module_editor.count %>)
              <i class="far fa-question-circle helpdesk ml-2" 
                 tabindex="0"  
                 data-toggle="popover" data-trigger="focus" 
                 title="Info" 
                 data-content="Dies ist eine Liste aller Vorlesungen, die zu
                 Modulen gehören, für die du EditorIn bist, abzüglich der Vorlesungen, die Du selbst als DozentIn gehalten hast. Durch Deine Rechte als ModuleditorIn erbst Du Bearbeitungsrechte an diesen Vorlesungen.">
              </i>
              <%= render partial: 'administration/lectures_card',
                         locals: { lectures: Lecture.sort_by_date(current_user.lectures_as_module_editor),
                                   inspection: false,
                                   teacher: true } %>
            <% end %>
            <% if current_user.given_lectures.empty? &&
                  current_user.edited_lectures.empty? &&
                  current_user.lectures_as_module_editor.empty? %>
              Es gibt keine Vorlesung, für die Du als DozentIn oder EditorIn
              eingetragen bist.
            <% end %>
          </div>
        </div>
      </div>
      <div class="col-5">
        <div class="card">
          <div class="card-header bg-primary text-white">
            <div class="row">
              <div class="col-8">
                Meine Module
                (<%= current_user.edited_courses.count  %>)
                <i class="far fa-question-circle helpdesk ml-2" 
                   tabindex="0"  
                   data-toggle="popover" data-trigger="focus" 
                   title="Info" 
                   data-content="Dies ist eine Liste aller Module, für die Du EditorIn bist und damit Bearbeitungsrechte hast.">
                </i>
              </div>
              <div class="col-4 text-right">
                <% if current_user.admin? %>
                  <%= link_to 'Modul anlegen', new_course_path,
                              class: 'btn btn-outline-light',
                              remote: true,
                              id: 'create-new-course' %>
                  <% end %>
              </div>
            </div>
          </div>
          <div class="card-body">
            <div id="new-course-area" 
                 class="bg-green-lighten-4 p-3 mb-3 rounded"
                 style="display: none;">
              <%= render partial: 'courses/new',
                         locals: { course: Course.new } %>
            </div>
            <% if current_user.edited_courses.present? %>
              <%= render partial: 'administration/courses_card',
                         locals: { courses: current_user.edited_courses.sort_by(&:title),
                                   inspection: false } %>
            <% else %>
              Es gibt keine Module, für die Du als EditorIn eingetragen bist.
            <% end %>
          </div>
        </div>
      </div>
    </div>
    <div class="row mt-3">
      <div class="col-7">
        <div class="card">
          <div class="card-header bg-teal-lighten-4">
            Sonstige Vorlesungen
            (<%= current_user.teaching_unrelated_lectures.count  %>)
            <i class="far fa-question-circle helpdesk ml-2" 
               tabindex="0"  
               data-toggle="popover" data-trigger="focus" 
               title="Info" 
               data-content="Dies ist eine Liste aller Vorlesungen, für die Du keine Bearbeitungsrechte hast. (Es sei denn, Du bist Admin :-P )">
            </i>
          </div>
          <div class="card-body">
            <% if current_user.teaching_unrelated_lectures.present? %>
              <%= render partial: 'administration/lectures_card',
                         locals: { lectures: Lecture.sort_by_date(current_user.teaching_unrelated_lectures),
                                   inspection: true,
                                   teacher: true } %>
            <% else %>
              Es gibt keine sonstigen Vorlesungen.
            <% end %>
          </div>
        </div>
      </div>
      <div class="col-5">
        <div class="card">
          <div class="card-header bg-teal-lighten-4">
            Sonstige Module
            (<%= Course.count - current_user.edited_courses.count  %>)
            <i class="far fa-question-circle helpdesk ml-2" 
               tabindex="0"  
               data-toggle="popover" data-trigger="focus" 
               title="Info" 
               data-content="Dies ist eine Liste aller Vorlesungen, für die Du kein(e) EditorIn bist und somit keine Bearbeitungsrechte hast. (Es sei denn, Du bist Admin :-P )">
            </i>
          </div>
          <div class="card-body">
            <% if (Course.all - current_user.edited_courses).present? %>
              <%= render partial: 'administration/courses_card',
                         locals: { courses: (Course.all - current_user.edited_courses).sort_by(&:title),
                                   inspection: true } %>
            <% else %>
              Es gibt keine sonstigen Module.
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="col-4">
    <div class="card">
      <div class="card-header bg-primary text-white">
        Meine Medien
        (<%= current_user.edited_media.count %>)
        <i class="far fa-question-circle helpdesk ml-2" 
               tabindex="0"  
               data-toggle="popover" data-trigger="focus" 
               title="Info" 
               data-content="Dies ist eine Liste aller Vorlesungen, für die Du als BearbeiterIn eingetragen bist. Medien, für Die Du Bearbeitungsrechte
               erbst (beispielsweise als ModuleditorIn), sind in dieser Liste nicht aufgeführt.">
        </i>
      </div>
      <div class="card-body">
        <% if current_user.edited_media.present? %>
          <ul>
            <% current_user.edited_media.order(:updated_at).reverse.first(25).each do |m| %>
              <li>
                <%= link_to m.title, edit_medium_path(m) %>
              </li>
            <% end %>
          </ul>
          <% if current_user.edited_media.count > 25 %>
            Es werden nur die 25 zuletzt geupdateten Medien angezeigt.
            Mehr Medien findest Du über die
            <%= link_to 'Mediensuche', media_catalog_path %>.
          <% end %>
        <% else %>
          Es gibt keine Medien, für die Du als EditorIn eingetragen bist.
        <% end %>
      </div>
    </div>
  </div>
</div>
