<%= form_with model: cohort,
              id: dom_id(cohort, "form"),
              data: {
                turbo: true,
                controller: "capacity-guard",
                action: "submit->capacity-guard#submit",
                capacity_guard_current_count_value: cohort.members.count,
                capacity_guard_confirm_message_value: t("roster.warnings.capacity_reduction")
              } do |f| %>
  <%= f.hidden_field :lecture_id, value: cohort.context.id %>
  <%= hidden_group_type_field(params[:group_type]) %>
  <div class="modal-body">
    <div class="mb-3">
      <%= f.label :title, t("basics.title"), class: "form-label" %>
      <%= f.text_field :title, class: "form-control" %>
    </div>

    <div class="mb-3">
      <%= f.label :description, t("basics.description"), class: "form-label" %>
      <%= helpdesk(t("roster.hints.cohort_description"), false) %>
      <%= f.text_area :description, class: "form-control", rows: 3 %>
    </div>

    <% if cohort.new_record? %>
      <div class="mb-3 form-check">
        <%= f.check_box :propagate_to_lecture, class: "form-check-input" %>
        <%= f.label :propagate_to_lecture, t("roster.cohorts.propagate_to_lecture"), class: "form-check-label" %>
        <div class="form-text">
          <%= t("roster.hints.cohort_propagate_to_lecture") %>
          <div class="mt-1 text-danger">
            <%= t("roster.warnings.setting_cannot_be_changed") %>
          </div>
        </div>
      </div>
    <% else %>
      <div class="mb-3">
        <%= t("roster.cohorts.lecture_enrollment") %>:
        <% if cohort.propagate_to_lecture? %>
          <span class="badge bg-success"><%= t("roster.cohorts.with_lecture_enrollment") %></span>
          <div class="form-text mt-1"><%= t("roster.hints.cohort_already_propagating") %></div>
        <% else %>
          <span class="badge bg-secondary"><%= t("roster.cohorts.without_lecture_enrollment") %></span>
          <div class="form-text mt-1"><%= t("roster.hints.cohort_is_isolated") %></div>
        <% end %>
      </div>
    <% end %>

    <div class="mb-3">
      <%= f.label :capacity, t("basics.capacity"), class: "form-label" %>
      <%= f.number_field :capacity,
            class: "form-control",
            min: 0,
            placeholder: "âˆž",
            data: { capacity_guard_target: "input" } %>
    </div>
  </div>

  <div class="modal-footer">
    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"><%= t("buttons.cancel") %></button>
    <%= f.submit t("buttons.save"), class: "btn btn-primary" %>
  </div>
<% end %>
